<div class="d-flex justify-content-between align-items-center mb-4">
  <h1>
    <i class="fas fa-file-powerpoint text-orange me-2"></i>
    PowerPointファイル一覧
  </h1>
  <%= link_to "ポートフォリオに戻る", @portfolio, class: "btn btn-outline-secondary" %>
</div>

<div class="mb-3">
  <h5><%= @portfolio.title %></h5>
  <p class="text-muted"><%= @portfolio.description %></p>
</div>

<% if @powerpoints.any? %>
  <div class="row">
    <% @powerpoints.each do |powerpoint| %>
      <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100">
          <div class="card-header bg-orange text-white">
            <h6 class="mb-0">
              <i class="fas fa-file-powerpoint me-2"></i>
              <%= truncate(powerpoint.filename, length: 30) %>
            </h6>
          </div>
          
          <div class="card-body">
            <p class="card-text small text-muted">
              <%= powerpoint.description || "説明なし" %>
            </p>
            
            <div class="mb-3">
              <div class="small text-muted">
                <div><strong>ファイル名:</strong> <%= powerpoint.original_filename %></div>
                <div><strong>サイズ:</strong> <%= number_to_human_size(powerpoint.file_size) %></div>
                <div><strong>作成日:</strong> <%= powerpoint.created_at.strftime("%Y/%m/%d %H:%M") %></div>
                <div><strong>種類:</strong> 
                  <span class="badge <%= powerpoint.is_generated? ? 'bg-success' : 'bg-primary' %>">
                    <%= powerpoint.is_generated? ? '生成' : 'アップロード' %>
                  </span>
                </div>
              </div>
            </div>
          </div>
          
          <div class="card-footer">
            <div class="btn-group w-100" role="group">
              <%= link_to "詳細", [@portfolio, powerpoint], class: "btn btn-outline-primary btn-sm" %>
              <%= link_to "プレビュー", preview_portfolio_powerpoint_path(@portfolio, powerpoint), 
                          class: "btn btn-outline-info btn-sm", target: "_blank" %>
              <%= link_to "ダウンロード", download_portfolio_powerpoint_path(@portfolio, powerpoint), 
                          class: "btn btn-outline-success btn-sm" %>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <div class="text-center py-5">
    <i class="fas fa-file-powerpoint fa-3x text-muted mb-3"></i>
    <h3 class="text-muted">PowerPointファイルがありません</h3>
    <p class="text-muted">このポートフォリオにはPowerPointファイルが登録されていません。</p>
    <%= link_to "ポートフォリオに戻る", @portfolio, class: "btn btn-primary" %>
  </div>
<% end %>

<style>
.bg-orange {
  background-color: #fd7e14 !important;
}
.text-orange {
  color: #fd7e14 !important;
}
</style>